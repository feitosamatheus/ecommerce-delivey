@{
    ViewData["Title"] = "Home Page";
}

<div class="my-3">
    <div class="row g-3">
        <div class="col-12 col-lg-9">

            <!-- FILTRO -->
            <div class="bc-filter bc-filter--sticky p-3 box-shadown-custom mb-3">
                <div class="row g-3 align-items-center">
                    <div class="col-12 col-md px-1">
                        <div class="d-flex gap-3 align-items-center">

                            <!-- SELECT CATEGORIA -->
                            <div class="bc-select" data-name="filtroTipo" id="filtroCategoria">
                                <button type="button" class="bc-select__trigger">
                                    <span class="bc-select__value">Selecionar uma categoria</span>
                                    <span class="bc-select__arrow"></span>
                                </button>

                                <ul class="bc-select__options">
                                    <li data-value="">Selecionar uma categoria</li>
                                    <li data-value="A">Tipo A</li>
                                    <li data-value="B">Tipo B</li>
                                </ul>

                                <select name="filtroTipo" hidden>
                                    <option value="">Selecionar uma categoria</option>
                                    <option value="A">Tipo A</option>
                                    <option value="B">Tipo B</option>
                                </select>
                            </div>

                            <!-- INPUT BUSCA (inicialmente oculto) -->
                            <div class="position-relative d-none bc-filter__search" id="filtroTexto">
                                <i class="bi bi-search bc-filter__icon"></i>
                                <input type="text" id="filtroNome" class="form-control bc-filter__input" placeholder="Buscar por nome" />
                                <button type="button" class="bc-filter__close" id="btnFecharBusca" aria-label="Fechar busca">
                                    <i class="fa-solid fa-xmark" aria-hidden="true"></i>
                                </button>
                            </div>

                            <!-- BOTÃO ABRIR BUSCA -->
                            <button class="btn bc-filter__btn" type="button" id="btnPesquisar" aria-label="Buscar" title="Buscar por nome">
                                <i class="fa-solid fa-keyboard"></i>
                            </button>

                        </div>
                    </div>
                </div>
            </div>

            <!-- PAINEL + CARROSSEL -->
            <div class="bc-panel p-3 mb-3">
                <div class="d-flex align-items-center justify-content-between mb-3">
                    <h5 class="mb-0 fw-bold">CALDOS</h5>
                </div>

                <div id="carrosselCaldos" class="carousel slide mb-2" data-bs-ride="false">
                     <!-- INDICADORES (pontinhos) -->
                    <div class="carousel-indicators bc-carousel__indicators">
                        <button type="button"
                                data-bs-target="#carrosselCaldos"
                                data-bs-slide-to="0"
                                class="active"
                                aria-current="true"
                                aria-label="Slide 1"></button>

                        <button type="button"
                                data-bs-target="#carrosselCaldos"
                                data-bs-slide-to="1"
                                aria-label="Slide 2"></button>
                    </div>
                    <div class="carousel-inner">

                        <div class="carousel-item active">
                            <div class="row g-3 ">
                                <div class="col-12 col-md-4">
                                    <div class="bc-product p-3">
                                        <div class="d-flex gap-3">
                                            <div class="flex-grow-1 bc-product__info">
                                                <div class="fw-bold">CALDO DE MANDIOCA 100ML</div>
                                                <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                                <div class="mt-2 fw-bold">R$ 17,00</div>
                                            </div>
                                            <div class="bc-product__thumb"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 col-md-4">
                                    <div class="bc-product p-3">
                                        <div class="d-flex gap-3">
                                            <div class="flex-grow-1 bc-product__info">
                                                <div class="fw-bold">CALDO DE MANDIOCA 100ML</div>
                                                <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                                <div class="mt-2 fw-bold">R$ 17,00</div>
                                            </div>
                                            <div class="bc-product__thumb"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 col-md-4">
                                    <div class="bc-product p-3">
                                        <div class="d-flex gap-3">
                                            <div class="flex-grow-1 bc-product__info">
                                                <div class="fw-bold">CALDO DE MANDIOCA 250ML</div>
                                                <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                                <div class="mt-2 fw-bold">R$ 24,00</div>
                                            </div>
                                            <div class="bc-product__thumb"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="carousel-item">
                            <div class="row g-3">
                                <div class="col-12 col-md-4">
                                    <div class="bc-product p-3">
                                        <div class="d-flex gap-3">
                                            <div class="flex-grow-1 bc-product__info">
                                                <div class="fw-bold">CALDO DE MANDIOCA 300ML</div>
                                                <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                                <div class="mt-2 fw-bold">R$ 17,00</div>
                                            </div>
                                            <div class="bc-product__thumb"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 col-md-4">
                                    <div class="bc-product p-3">
                                        <div class="d-flex gap-3">
                                            <div class="flex-grow-1 bc-product__info">
                                                <div class="fw-bold">CALDO DE MANDIOCA 450ML</div>
                                                <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                                <div class="mt-2 fw-bold">R$ 24,00</div>
                                            </div>
                                            <div class="bc-product__thumb"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- CONTROLES -->
                    <button class="carousel-control-prev bc-carousel__btn"
                            type="button"
                            data-bs-target="#carrosselCaldos"
                            data-bs-slide="prev">
                        <i class="fa-solid fa-chevron-left"></i>
                    </button>

                    <button class="carousel-control-next bc-carousel__btn"
                            type="button"
                            data-bs-target="#carrosselCaldos"
                            data-bs-slide="next">
                        <i class="fa-solid fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <!-- LISTAS (mantive estrutura e cards, apenas classes) -->
            <div class="bc-panel p-3 mb-2">
                <h5 class="mb-3 fw-bold">CALDOS</h5>

                <div class="row g-3">
                    <div class="col-12 col-md-6">
                        <div class="bc-product p-3">
                            <div class="d-flex gap-3">
                                <div class="flex-grow-1 bc-product__info">
                                    <div class="fw-bold">CALDO DE MANDIOCA 500ML</div>
                                    <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                    <div class="mt-2 fw-bold">R$ 17,00</div>
                                </div>
                                <div class="bc-product__thumb"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-md-6">
                        <div class="bc-product p-3">
                            <div class="d-flex gap-3">
                                <div class="flex-grow-1 bc-product__info">
                                    <div class="fw-bold">CALDO DE MANDIOCA 750ML</div>
                                    <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                    <div class="mt-2 fw-bold">R$ 24,00</div>
                                </div>
                                <div class="bc-product__thumb"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-md-6">
                        <div class="bc-product p-3">
                            <div class="d-flex gap-3">
                                <div class="flex-grow-1 bc-product__info">
                                    <div class="fw-bold">CALDO DE MANDIOCA 500ML</div>
                                    <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                    <div class="mt-2 fw-bold">R$ 17,00</div>
                                </div>
                                <div class="bc-product__thumb"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-md-6">
                        <div class="bc-product p-3">
                            <div class="d-flex gap-3">
                                <div class="flex-grow-1 bc-product__info">
                                    <div class="fw-bold">CALDO DE MANDIOCA 750ML</div>
                                    <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                    <div class="mt-2 fw-bold">R$ 24,00</div>
                                </div>
                                <div class="bc-product__thumb"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-md-6">
                        <div class="bc-product p-3">
                            <div class="d-flex gap-3">
                                <div class="flex-grow-1 bc-product__info">
                                    <div class="fw-bold">CALDO DE MANDIOCA 500ML</div>
                                    <div class="text-muted small">COM CARNE, BACON E CALABRESA...</div>
                                    <div class="mt-2 fw-bold">R$ 17,00</div>
                                </div>
                                <div class="bc-product__thumb"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- CARRINHO -->
        <div class="col-12 col-lg-3">
            <div class="bc-panel p-3 bc-cart bc-cart--sticky">
                <div class="d-flex align-items-center justify-content-between mb-2">
                    <h5 class="mb-0 fw-bold bc-cart__title">Carrinho</h5>
                </div>

                <hr />

                <div class="bc-cart__empty py-4 text-center">
                    <div class="bc-cart__illustration mb-3"></div>
                    <div class="text-muted">Seu carrinho está vazio</div>
                </div>

                <hr />

                <div class="mb-3">
                    <div class="fw-bold mb-2">Totais</div>

                    <div class="d-flex justify-content-between text-muted">
                        <span>Subtotal</span><span>R$ 0,00</span>
                    </div>

                    <div class="d-flex justify-content-between text-muted">
                        <span>Entrega</span><span>R$ 0,00</span>
                    </div>

                    <div class="d-flex justify-content-between fw-bold bc-cart__total">
                        <span>Total</span><span>R$ 0,00</span>
                    </div>
                </div>

                <button class="btn w-100 btn-secondary" disabled>
                    ESTABELECIMENTO FECHADO
                </button>
            </div>
        </div>

    </div>
</div>

<script>
(function () {
  // Sticky do filtro
  const filtro = document.querySelector('.bc-filter');
  if (!filtro) return;

  const offsetTop = filtro.offsetTop;

  window.addEventListener('scroll', () => {
    if (window.scrollY > offsetTop - 15) {
      filtro.classList.add('is-sticky');
    } else {
      filtro.classList.remove('is-sticky');
    }
  });

  // Busca por texto (toggle)
  const btnPesquisar = document.getElementById('btnPesquisar');
  const btnFecharBusca = document.getElementById('btnFecharBusca');
  const filtroCategoria = document.getElementById('filtroCategoria');
  const filtroTexto = document.getElementById('filtroTexto');
  const inputBusca = document.getElementById('filtroNome');

  let modoBuscaTexto = false;

  function abrirBuscaTexto() {
    filtroCategoria.classList.add('d-none');
    filtroTexto.classList.remove('d-none');
    btnPesquisar.classList.add('d-none');
    modoBuscaTexto = true;
    inputBusca.focus();
  }

  function fecharBuscaTexto() {
    filtroTexto.classList.add('d-none');
    filtroCategoria.classList.remove('d-none');
    btnPesquisar.classList.remove('d-none');
    modoBuscaTexto = false;
    inputBusca.value = '';
  }

  btnPesquisar?.addEventListener('click', () => {
    if (!modoBuscaTexto) {
      abrirBuscaTexto();
      return;
    }
    console.log('Buscar por:', inputBusca.value);
  });

  btnFecharBusca?.addEventListener('click', fecharBuscaTexto);

  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && modoBuscaTexto) {
      fecharBuscaTexto();
    }
  });

  // Select custom (delegação + 1 click global)
  const selects = Array.from(document.querySelectorAll('.bc-select'));

  function closeAllSelects(except = null) {
    selects.forEach(s => {
      if (s !== except) s.classList.remove('is-open');
    });
  }

  selects.forEach(select => {
    const trigger = select.querySelector('.bc-select__trigger');
    const options = Array.from(select.querySelectorAll('.bc-select__options li'));
    const valueSpan = select.querySelector('.bc-select__value');
    const nativeSelect = select.querySelector('select');

    trigger?.addEventListener('click', (e) => {
      e.stopPropagation();
      const willOpen = !select.classList.contains('is-open');
      closeAllSelects(select);
      select.classList.toggle('is-open', willOpen);
    });

    options.forEach(option => {
      option.addEventListener('click', (e) => {
        e.stopPropagation();

        options.forEach(o => o.classList.remove('is-selected'));
        option.classList.add('is-selected');

        valueSpan.textContent = option.textContent;

        if (nativeSelect) nativeSelect.value = option.dataset.value || '';

        select.classList.remove('is-open');
      });
    });
  });

  document.addEventListener('click', () => closeAllSelects());
})();
</script>
